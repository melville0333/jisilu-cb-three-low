# 集思录 可转债 三低策略脚本

## 项目描述
本 Tampermonkey 脚本专为集思录（jisilu.cn）可转债列表设计，实现“三低”策略辅助工具。脚本会在表格右侧自动添加“三低”得分列和“排名”列，帮助用户快速筛选优质可转债。

核心策略：优先选择现价较低、转股溢价率较低、剩余规模较小的转债，同时排除各类风险券（高价、强赎、仙股、破净、剩余年限过短等），并按 **价格 + 转股溢价率 + 剩余规模×10** 的综合得分排序。

## 主要功能
- **三低得分列**：实时计算综合得分，符合排除条件的转债统一显示为 9999 并标红。
- **现价阈值输入框**：位于“三低”表头下方，可自定义现价上限（默认 150），超过该值的转债得分强制为 9999。
- **实时排名列**：始终反映当前页面显示顺序，第一行显示 1，依次递增；每 5 名（5、10、15…）标红突出。
- **排除规则**（自动将得分设为 9999）：
  - 现价超过自定义阈值
  - 正股价 < 2 元
  - 正股 PB < 1
  - 剩余年限 < 1.5 年 或 显示为“XX天”
  - 强赎状态包含“最后交易”“已公告强赎”“已满足强赎条件”
  - 强赎倒计时 ≤ 8 天（“至少还需 X 天”）
- **三低排序**：点击“三低”表头可在升序/降序间切换，得分低的优质券排在前。
- **完全兼容**：支持集思录原生排序、翻页、筛选等操作，排名与得分实时更新，页面流畅无卡顿。
- **动态适配**：自动识别表头列位置，即使集思录调整栏目顺序也能正常工作。

## 安装方法
1. 安装 Tampermonkey 浏览器扩展（Chrome / Edge / Firefox 均可）。
2. 打开 Tampermonkey 仪表盘，点击“创建新脚本”。
3. 将本仓库中的 `jisilu-cb-three-low.user.js` 内容完整复制粘贴，保存即可。
4. 访问集思录可转债列表页面（https://www.jisilu.cn/data/cbnew/ 或 https://www.jisilu.cn/web/data/cb/list），脚本自动生效。

## 使用说明
- **三低列**：显示综合得分，9999 表示已被排除（红底白字）。
- **排名列**：实时序号，便于快速定位；每 5 名红底突出。
- **现价阈值**：在“三低”表头下方输入框修改数字后按回车或失焦，即可实时过滤高价转债。
- **排序**：点击“三低 ↑/↓”文字切换排序方向，优质券将排在前面。
- 与集思录原生功能完全兼容，所有操作均会触发实时刷新。

## 截图
![表头与输入框](images/header.png)  
![排序后效果](images/sorted.png)  
（请将实际截图放入 `images/` 目录并替换链接）

## 注意事项
- 脚本依赖集思录当前页面结构，如网站进行大幅改版可能需要更新。
- 本脚本仅供学习与个人使用，投资有风险，使用者需自行判断。
- 如有问题或建议，欢迎在 GitHub Issues 中反馈。

## 开发与贡献
- 脚本基于 DOM 操作与 MutationObserver 实现实时更新。
- 欢迎 Fork 本仓库，进行功能改进后提交 Pull Request。
- 许可证：MIT，可自由使用、修改与分发。

## 更新日志
- v3.9（最新）：全面代码优化，增加详细注释，提高可读性与稳定性。
- v3.8：新增剩余年限含“天”自动排除。
- v3.7：排名每 5 名标红。
- v3.6：添加现价阈值输入框。
- …（后续版本请在此补充）

感谢使用！祝您投资顺利。
